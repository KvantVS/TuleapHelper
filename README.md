https://gitlab.cl.nat.kz/vadim.sidorchuk/TuleapHelper

Цели:

Автоматизировать операции с тулипом при исправлении багов (а впоследствии и не только багов): 
 - по завершению работы над багом или отдельно - создание физического патча из измененных библиотек;
 - создание патча в тулипе;
 - при старте работы над багом автоматически создать таск в тулипе;
 - при завершении работы над багом - подсчет затраченного времени на баг, с учетом рабочего времени 9:00-18:00 или календаря (с возможностью вручную указать кол-во затрач.часов) + смена статуса багу, смена статуса таску (закрытие таска).

Патч собирается автоматически из указанных библиотек (при выборе библиотек видна дата обновления библиотек из обеих папок - Debug и Release), создается zip-файл патч с наименованием по шаблону, принятым на проекте, включая наименование библиотек. Автоматически (при необходимости) копируется в папку на BuildKrg "\\buildkrg\GE-ESEDO\Сборка на тестирование\1.1.0". 

В тулипе автоматически создается патч-артефакт, назначается на того, кто зарегистрировал багу, проставляются пользователи, кого уведомить (по умолчанию сразу выбраны 4 пользователя: все разработчики на проекте и тот, кто будет ставить патч (Виктор)), заполняются остальные поля (автоматически с возможностью скорректировать вручную): путь к патчу, наименование патча, ветка, изменения, зав.функционал, № артефакта-баги в референсах;

- возможность включить в патч SQL-скрипт из папки "git-esedo\Other\BuildScripts" (не реализовано);
- возможность включить в патч DOC-шаблоны документов (не рализовано);

Все данные берутся из тулипа посредством API Тулипа (реализовано через REST): проекты, пользователи проекта, артефакты (патчи, баги, таски).

=======================
Работа с программой на текущий момент:

Авторизуемся;
Загружаем проекты (ждём);
Получаем все незакрытые баги.
Работаем с багами - ПКМ по багу, в контекстном меню выбираем что-нибудь.

=======================
Полезные ссылки:
 - https://tuleap.nat.kz/help/api - документация по API
 - https://tuleap.nat.kz/api/explorer/ - проводник по структуре тулипа, объектам и методам (откроется только если referer=https://tuleap.nat.kz/help/api, на той странице также есть эта ссылка). Для доступа к большему количеству объектов нужно быть авторизованным.
 - https://tuleap.nat.kz/doc/en/user-guide/rest.html - начальная документация Tuleap REST API

 - http://json2csharp.com/ - генерация C#-классов из json-объектов
 - http://json.parser.online.fr/ - парсер json
 - https://confluence.jetbrains.com/display/TCD10/REST+API - REST API для TeamCity

=======================
= Структура проекта =

Формы:
Form1 - основная форма
frmSettings - форма настроек
TuleapPatchCreateForm - форма создания патча. Открывается по нажатию кнопки "Создать патч для Т2"

Классы:
CommonVariables.cs - Общие переменные/константы для проекта
Configurator.cs - Класс для работы с файлом конфигурации.
FileSystem.cs - класс-помощник по работе с файловой системой (создание физического патча)
HttpLevel.cs - класс для работы с http-запросами
TuleapLevel.cs - уровень тулипа. Авторизация, Работа с артефактами (создание, обновление артефакта)
TuleapClasses.cs - классы для работы с Tuleap`ом;
ListViewColumnSorter.cs - реализация IComparer-интерфейса для сортировки столбцов в ListView dll-библиотек (на форме создания патча)
EsedoLib.cs - библиотека проекта ESEDO

=======================

= ИДЕИ =

* для патчей - создать таблицу и столбцы с отображением, существует ли файл физически (удаленно и локально)

* Начал работу над багом - создается таск "Устранение Bugs #xxxx - <description>"
Приостановил работу над багом - ищется таск, ставится "Приостановлено"
Завершить работу над багом - ищется таск, высчитывается время, ставится "Завершено".
(В пятницу если работа над багом не завершена - ...)

* При выборе библиотек делать список в один столбик, прокручиваемый
Возле каждой либы - дата изменения файла .dll этой либы

* Задачи: отображаются по умолчанию все, сделать чекбокс "Только открытые задачи"

* начал таск - записалось время
закончил - записалось время
расчитывается разница, плюс учитывается рабочее время, получается сколько часов работал над таском. Окно подтверждения, правильно ли посчитано время (вы работчали __ (10) часов, Верно?)

* 2 галки напротив патча (протестировано, установлено)

* Галочками из списка выбираем какие SQL добавлять в патч
* Этот список собирается из файлов папки BuildScripts
* нажимаем файл - справа открывается предпросмотр

* "Закончить работу над багом" - нажимаем => если задач связанных с багом больше одной, то появляется список задач вида "имя - дата создания - дата посл.изменения", выбираем задачу, нажимаем ОК, закрывается эта задача и Баг. (такого быть не может, должна быть открыта только одна задача по одной баге, по идее)

* "при начале работы над багом:" открывается окно, в котором выбираем галочками действия, которые будут выполнены: создание артефакта-задачи в тулипе, перевод статуса баги в "В работе" и т.д.

* "При завершении работы над багом:": галочки: Закрыть таск в тулипе, сменить статус бага, создание артфекта-патча в тулипе, создание физического патча

* настройку "Перезаписывать патч? Или добавлять к счетчику в конце имени файла +1?"

* При создании артефакта - галочку "выберите проект, в котором создать артефакт"
